<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solar System Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <div class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-lg">
    <h1 class="text-xl font-bold mb-4 text-center">⚡ Solar System Calculator</h1>
   <!-- Country Dropdown -->
<div class="relative w-full mb-4">
  <label class="block mb-2 font-medium text-sm sm:text-base">Country:</label>

  <!-- Selected value -->
  <div 
    id="dropdownButton" 
    class="w-full p-3 border rounded-lg cursor-pointer bg-white"
  >
    -- Select Country --
  </div>

  <!-- Dropdown menu -->
  <div id="dropdownMenu" class="absolute z-10 w-full bg-white border rounded-lg mt-1 hidden max-h-60 overflow-y-auto shadow-lg">
    
    <!-- Search box -->
    <input 
      type="text" 
      id="countrySearch" 
      placeholder="Search country..." 
      class="w-full p-2 border-b outline-none"
    >
    
    <!-- Country options -->
    <div id="countryOptions">
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Australia">Australia</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Brazil">Brazil</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Canada">Canada</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="China">China</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Egypt">Egypt</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Germany">Germany</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Ghana">Ghana</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="India">India</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Japan">Japan</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Kenya">Kenya</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Mexico">Mexico</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Nigeria">Nigeria</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="SouthAfrica">South Africa</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="UK">United Kingdom</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="USA">United States</div>
    </div>
  </div>

  <!-- Hidden input to hold value -->
  <input type="hidden" id="country">
</div>



    <!-- Load Input -->
    <label class="block mb-2 font-medium">Load (W):</label>
    <input id="load" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 500">

    <!-- Usage Hours -->
    <label class="block mb-2 font-medium">Usage Time (Hours):</label>
    <input id="usageHrs" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 5">

    <!-- Backup Hours -->
    <label class="block mb-2 font-medium">Backup Hours (Autonomy):</label>
    <input id="backupHrs" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 2">

    <!-- System Voltage -->
    <label class="block mb-2 font-medium">System Voltage (V):</label>
    <input id="systemV" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 24">

    <!-- Solar Panel Wattage -->
    <label class="block mb-2 font-medium">Solar Panel Wattage (Wp):</label>
    <input id="panelW" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 300">

    <!-- Battery Voltage -->
    <label class="block mb-2 font-medium">Battery Voltage (V):</label>
    <input id="batteryV" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 12">

    <!-- Battery Capacity -->
    <label class="block mb-2 font-medium">Battery Capacity (Ah):</label>
    <input id="batteryAh" type="number" class="w-full p-3 border rounded-lg mb-4" placeholder="e.g. 200">

    <!-- Battery Type -->
    <label class="block mb-2 font-medium">Battery Type:</label>
    <select id="batteryType" class="w-full p-3 border rounded-lg mb-4">
      <option value="tubular">Tubular (Lead-Acid)</option>
      <option value="lithium">Lithium</option>
    </select>

    <!-- Calculate button -->
    <button 
  id="calculateBtn"
  onclick="calculateSystem()" 
  class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition">
  Calculate
</button>

 <!-- Contact Section -->
<div class="mt-10 text-center">
  <h2 class="text-lg font-semibold mb-4">Connect With Me</h2>
  <div class="flex justify-center space-x-4">
    <!-- WhatsApp -->
    <a href="https://wa.me/2348143369102" target="_blank" 
       class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">
      WhatsApp
    </a>

    <!-- Instagram -->
    <a href="https://www.instagram.com/tifeosame?igsh=MTQ5cW5sNGlhbHp5cA==" target="_blank" 
       class="bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 transition">
      Instagram
    </a>

    <!-- Email -->
    <a href="mailto:tonyifeosame@gmail.com" target="_blank"
       class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
      Email
    </a>
  </div>
</div>


    <!-- Results -->
    <div id="results" class="hidden mt-6 p-4 bg-gray-50 rounded-lg border"></div>
  </div>

  <script>
   const dropdownBtn = document.getElementById("dropdownButton");
const dropdownMenu = document.getElementById("dropdownMenu");
const countrySearch = document.getElementById("countrySearch");
const countryOptions = document.getElementById("countryOptions").children;
const hiddenInput = document.getElementById("country");

// Toggle menu
dropdownBtn.addEventListener("click", () => {
  dropdownMenu.classList.toggle("hidden");
  countrySearch.value = "";
  filterOptions("");
});

// Filter function
countrySearch.addEventListener("keyup", () => {
  filterOptions(countrySearch.value.toLowerCase());
});

function filterOptions(search) {
  for (let option of countryOptions) {
    const txt = option.innerText.toLowerCase();
    option.style.display = txt.includes(search) ? "" : "none";
  }
}

// Select option
for (let option of countryOptions) {
  option.addEventListener("click", () => {
    dropdownBtn.innerText = option.innerText;  // show selected
    hiddenInput.value = option.getAttribute("data-value"); // set hidden value
    dropdownMenu.classList.add("hidden"); // close menu
  });
}

// Close if click outside
document.addEventListener("click", (e) => {
  if (!e.target.closest("#dropdownMenu") && !e.target.closest("#dropdownButton")) {
    dropdownMenu.classList.add("hidden");
  }
});

    function calculateSystem() {
      const load = parseFloat(document.getElementById("load").value);
      const usageHrs = parseFloat(document.getElementById("usageHrs").value);
      const backupHrs = parseFloat(document.getElementById("backupHrs").value);
      const systemV = parseFloat(document.getElementById("systemV").value);
      const panelW = parseFloat(document.getElementById("panelW").value);
      const batteryV = parseFloat(document.getElementById("batteryV").value);
      const batteryAh = parseFloat(document.getElementById("batteryAh").value);
      const batteryType = document.getElementById("batteryType").value;
      const country = document.getElementById("country").value;

      if (
        isNaN(load) || isNaN(usageHrs) || isNaN(backupHrs) ||
        isNaN(systemV) || isNaN(panelW) || isNaN(batteryV) || isNaN(batteryAh)
      ) {
        alert("⚠️ Please enter all values.");
        return;
      }

      // Sun hours per country
      const sunHoursData = {
        Australia: 9, Brazil: 7.5, Canada: 6.5, China: 7.5, Egypt: 11,
        Germany: 5.5, Ghana: 9.5, India: 9.5, Japan: 6.5, Kenya: 10,
        Mexico: 8, Nigeria: 8, SouthAfrica: 9, UK: 6.5, USA: 9.5
      };
      const sunHours = sunHoursData[country] || 6;
      const diversityFactor = 1.6;

      // Adjusted load
      const adjustedLoad = load / diversityFactor;

      // Battery properties
      let dod, efficiency;
      if (batteryType === "tubular") {
        dod = 0.5;
        efficiency = 0.85;
      } else {
        dod = 0.8;
        efficiency = 0.95;
      }

      // Energy calculations
      const dailyEnergy = adjustedLoad * usageHrs; // daily usage
      const totalEnergy = adjustedLoad * backupHrs; // backup capacity needed

      // Battery sizing
      const seriesBatteries = Math.ceil(systemV / batteryV);
      const groupCapacityWh = batteryAh * batteryV * seriesBatteries * dod * efficiency;
      const parallelGroups = Math.ceil(totalEnergy / groupCapacityWh);
      const totalBatteries = seriesBatteries * parallelGroups;

      // Inverter & Panels (with +10% margin)
      const inverterSize = Math.ceil(adjustedLoad * 1.2 * 1.1);
      const totalSolarWatt = (dailyEnergy / sunHours) * 1.1;
      const numPanels = Math.ceil(totalSolarWatt / panelW);

      // Display results
      document.getElementById("results").classList.remove("hidden");
      document.getElementById("results").innerHTML = `
        <p><strong>Battery Type:</strong> ${batteryType === "tubular" ? "Tubular (Lead-Acid)" : "Lithium"}</p>
        <p><strong>Adjusted Load:</strong> ${adjustedLoad.toFixed(2)} W</p>
        <p><strong>Daily Energy Usage:</strong> ${dailyEnergy.toFixed(2)} Wh/day</p>
        <p><strong>Total Backup Energy Needed:</strong> ${totalEnergy.toFixed(2)} Wh (${backupHrs} hrs backup)</p>
        <p><strong>Usable Capacity per String:</strong> ${groupCapacityWh.toFixed(2)} Wh</p>
        <p><strong>Batteries Needed:</strong> ${totalBatteries} (${seriesBatteries} in series × ${parallelGroups} parallel)</p>
        <p><strong>Inverter Size (with 10% margin):</strong> ${inverterSize} W / VA</p>
        <p><strong>Solar Panels Needed (with 10% margin):</strong> ${numPanels} × ${panelW} Wp</p>
      `;
        // ✅ Only update button AFTER successful calculation
  const calcBtn = document.getElementById("calculateBtn");
  calcBtn.classList.remove("bg-blue-500", "hover:bg-blue-600");
  calcBtn.classList.add("bg-green-500", "hover:bg-green-600");
  calcBtn.textContent = "Calculated ✅";
    }
   
    }
  </script>

</body>
</html>

