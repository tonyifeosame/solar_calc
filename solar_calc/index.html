<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solar Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-2 sm:p-4">
  <div class="bg-white shadow-lg rounded-2xl p-6 sm:p-8 w-full max-w-md">
    <h1 class="text-xl sm:text-2xl font-bold text-center mb-6">Solar System Calculator</h1>

  <!-- Searchable Country Dropdown -->
<div class="relative w-full mb-4">
  <label class="block mb-2 font-medium text-sm sm:text-base">Country:</label>
  
  <!-- Selected value (acts like a button) -->
  <div 
    id="dropdownButton" 
    class="w-full p-3 border rounded-lg cursor-pointer bg-white"
  >
    -- Select Country --
  </div>

  <!-- Dropdown menu -->
  <div id="dropdownMenu" class="absolute z-10 w-full bg-white border rounded-lg mt-1 hidden max-h-60 overflow-y-auto shadow-lg">
    
    <!-- Search box -->
    <input 
      type="text" 
      id="countrySearch" 
      placeholder="Search country..." 
      class="w-full p-2 border-b outline-none"
    >
    
      <!-- Options (Alphabetical) -->
    <div id="countryOptions">
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Australia">Australia</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Brazil">Brazil</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Canada">Canada</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="China">China</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Egypt">Egypt</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Germany">Germany</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Ghana">Ghana</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="India">India</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Japan">Japan</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Kenya">Kenya</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Mexico">Mexico</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="Nigeria">Nigeria</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="SouthAfrica">South Africa</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="UK">United Kingdom</div>
      <div class="p-2 hover:bg-blue-100 cursor-pointer" data-value="USA">United States</div>
    </div>
  </div>

  <!-- Hidden input to actually store selected value -->
  <input type="hidden" id="country">
</div>
    <!-- Load Input -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Load (Watts):</label>
    <input id="load" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 500">

    <!-- Usage Hours Input -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Usage Time (Hours):</label>
    <input id="hours" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 5">

    <!-- Backup Days -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Backup Days (Autonomy):</label>
    <input id="days" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 2">

    <!-- System Voltage -->
    <label class="block mb-2 font-medium text-sm sm:text-base">System Voltage (V):</label>
    <input id="systemV" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 12, 24, 48">

    <!-- Solar Panel Wattage -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Solar Panel Wattage (Wp):</label>
    <input id="panelW" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 300">

    <!-- Battery Voltage -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Battery Voltage (V):</label>
    <input id="batteryV" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 12">

    <!-- Battery Capacity -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Battery Capacity (Ah):</label>
    <input id="batteryAh" type="number" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base" placeholder="e.g. 200">

    <!-- Battery Type -->
    <label class="block mb-2 font-medium text-sm sm:text-base">Battery Type:</label>
    <select id="batteryType" class="w-full p-3 border rounded-lg mb-4 text-sm sm:text-base">
      <option value="tubular">Tubular (Lead-Acid)</option>
      <option value="lithium">Lithium</option>
    </select>

    <button onclick="calculateSystem()" class="w-full bg-blue-500 text-white py-3 rounded-lg text-base sm:text-lg font-medium hover:bg-blue-600 transition">Calculate</button>

    <!-- Results -->
    <div id="results" class="mt-6 hidden bg-gray-50 p-4 rounded-lg border text-sm sm:text-base overflow-x-auto"></div>
  </div>

  <script>
    function calculateSystem() {
      const load = parseFloat(document.getElementById("load").value);
      const hours = parseFloat(document.getElementById("hours").value);
      const days = parseFloat(document.getElementById("days").value);
      const systemV = parseFloat(document.getElementById("systemV").value);
      const panelW = parseFloat(document.getElementById("panelW").value);
      const batteryV = parseFloat(document.getElementById("batteryV").value);
      const batteryAh = parseFloat(document.getElementById("batteryAh").value);
      const batteryType = document.getElementById("batteryType").value;
      const country = document.getElementById("country").value;

      if (isNaN(load) || isNaN(hours) || isNaN(days) || isNaN(systemV) || isNaN(panelW) || isNaN(batteryV) || isNaN(batteryAh)) {
        alert("Please enter all values.");
        return;
      }

    // Sun hours per country
const sunHoursData = {
  Australia: 9,
  Brazil: 7.5,
  Canada: 6.5,
  China: 7.5,
  Egypt: 11,
  Germany: 5.5,
  Ghana: 9.5,
  India: 9.5,
  Japan: 6.5,
  Kenya: 10,
  Mexico: 8,
  Nigeria: 8,
  SouthAfrica: 9,
  UK: 6.5,
  USA: 9.5
};

      const sunHours = sunHoursData[country] || 6; // default 6 if not listed
      const diversityFactor = 1.6;

      // Adjusted load
      const adjustedLoad = load / diversityFactor;

      // Battery properties
      let dod, efficiency;
      if (batteryType === "tubular") {
        dod = 0.5;
        efficiency = 0.85;
      } else {
        dod = 0.8;
        efficiency = 0.95;
      }

      // Energy calculations
      const dailyEnergy = adjustedLoad * hours;
      const totalEnergy = dailyEnergy * days;
      const seriesBatteries = Math.ceil(systemV / batteryV);
      const groupCapacityWh = batteryAh * batteryV * seriesBatteries * dod * efficiency;
      const parallelGroups = Math.ceil(totalEnergy / groupCapacityWh);
      const totalBatteries = seriesBatteries * parallelGroups;
      const inverterSize = Math.ceil(adjustedLoad * 1.2);
      const totalSolarWatt = dailyEnergy / sunHours;
      const numPanels = Math.ceil(totalSolarWatt / panelW);

      // Display results
      document.getElementById("results").innerHTML = `
        <p><strong>Battery Type:</strong> ${batteryType === "tubular" ? "Tubular (Lead-Acid)" : "Lithium"}</p>
        <p><strong>Adjusted Load:</strong> ${adjustedLoad.toFixed(2)} W</p>
        <p><strong>Daily Energy:</strong> ${dailyEnergy.toFixed(2)} Wh/day</p>
        <p><strong>Total Storage Needed:</strong> ${totalEnergy.toFixed(2)} Wh</p>
        <p><strong>Usable Capacity per String:</strong> ${groupCapacityWh.toFixed(2)} Wh</p>
        <p><strong>Batteries Needed:</strong> ${totalBatteries} (${seriesBatteries} in series × ${parallelGroups} parallel)</p>
        <p><strong>Inverter Size:</strong> ${inverterSize} W / VA</p>
        <p><strong>Solar Panels Needed:</strong> ${numPanels} × ${panelW} Wp</p>
      `;
      document.getElementById("results").classList.remove("hidden");
    }
        // Search filter for country dropdown
    const dropdownBtn = document.getElementById("dropdownButton");
  const dropdownMenu = document.getElementById("dropdownMenu");
  const countrySearch = document.getElementById("countrySearch");
  const countryOptions = document.getElementById("countryOptions").children;
  const hiddenInput = document.getElementById("country");

  // Toggle dropdown
  dropdownBtn.addEventListener("click", () => {
    dropdownMenu.classList.toggle("hidden");
    countrySearch.value = "";
    filterOptions("");
  });

  // Search filter
  countrySearch.addEventListener("keyup", () => {
    filterOptions(countrySearch.value.toLowerCase());
  });

  function filterOptions(search) {
    for (let option of countryOptions) {
      const txt = option.innerText.toLowerCase();
      option.style.display = txt.includes(search) ? "" : "none";
    }
  }

  // Select country
  for (let option of countryOptions) {
    option.addEventListener("click", () => {
      dropdownBtn.innerText = option.innerText;
      hiddenInput.value = option.getAttribute("data-value");
      dropdownMenu.classList.add("hidden");
    });
  }

  // Close if click outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#dropdownMenu") && !e.target.closest("#dropdownButton")) {
      dropdownMenu.classList.add("hidden");
    }
  });
  </script>
</body>
</html>
